この章でやること

- アプリケーションの名前を決める
- アプリケーションの雛形を作成する
- データベースを作成する
- ビュー層を効率よく書くためにslimを使えるようにする
- アプリケーションの見栄えをよくするためにBootstrapを導入する
- railsのエラーメッセージ等を日本語で出せるようにする

# 3-1

## データベースの環境毎の使い分け

railsではデフォルトで3種類の環境が用意されており、1つの環境に対して1つのデータベースを対応させる。

|種類|システム名|用途|
--|--|--
|開発|development|開発時の動作確認を行う|
|テスト|test|自動テストを行う|
|本番|production|ユーザーが利用可能な形で稼働させる|

どの環境にどのようなデータベースを対応させるかは、config/database.ymlに記載する。


## slimを使えるようにする
slimはテンプレートエンジンの１つ。
利用すると、アプリケーションの画面をHTMLの構造が直感的にわかりやすいテンプレート形式で書くことができる。

## bootstrapを導入する
bootstrapはフロントエンドフレームワークの1つ。
手軽に程よく見栄えの良い画面を作成することができる。

## scssを利用する
rails newをした直後ではrailsはアプリケーション全体で1つのCSSファイルを読み込むようになっている。
今回はSCSSの記法でCSSを記述してみる。
新しくSCSS(applications.scss)を作成する。
上に伴い、もとからあるCSSファイルは削除する。

```
$ rm app/assets/stylesheets/application.css
```

次にSCSSファイルを作成する。
(詳細は書籍の方を参照)

これで各画面にBootstrapのデザインを反映できる状態になった。


## railsのエラーメッセージを日本語で出せるようにする
今回作るアプリは日本語のアプリケーションにしたいので、日本語の翻訳を追加して利用する言語を日本語に設定する。
日本語翻訳ファイルを持ってくる(書籍ではwgetを使っているが、macではそのコマンドが使えないのでcurlで叩く)
```
$ curl -o config/locales/ja.yml -L https://raw.github.com/svenfuchs/rails-i18n/master/rails/locale/ja.yml
```

# 3-2

railsのモデルは主に2つの要素から構成されている
- モデルに対するrubyのクラス
- モデルに対するデータベースのテーブル

モデルのクラス名とデータベースのテーブル名には以下のような命名の規約がある
- データベースのテーブル名はモデルのクラス名を複数系にしたもの
- モデルのクラス名はキャメルケース、テーブルはスネークケース

## タスクモデルの雛形を作成する
タスクモデルの生成にはジェネレータを利用する
ジェネレータはrails gの後に生成したいものの種類を指定し、更に生成したいものの種類ごとの必要な情報を添えて実行する。

```
bin/rails g model [モデル名] [属性名:データ型 属性名:データ型 ...] [オプション]
```

## マイグレーションでデータベースにテーブルを追加する
データベースにテーブルを追加するには、railsの用意しているマイグレーションという仕組みを使う。
マイグレーション: データベーススキーマへ変更の1つ1つをrubyのプログラムとして実現し、開発の歴史に沿って順番に実行することで最新のスキーマの状態にできるようにすること。
マイグレーションはスキーマの歴史をすすめるだけでなく戻す機能も備えているので、必要なところまでデータベースのスキーマの状態を戻す事ができる。

マイグレーションをデータベースに適用するには、rails db:migrateマンドを利用する

# 3-3
モデルが作成できたので、コントローラとビューを実装して、ブラウザ上で各操作を行えるようにする。
モデルと同様、コントローラとビューの雛形もジェネレータで作成することができる。

```
bin/rails g controller コントローラ名　[アクション名 アクション名 ...] [オプション]
```

アクション: リクエストに対しての処理を実行するためのメソッド。
具体的にはモデルを呼び出したり、画面を表示したりする。

<ここで抑えておくこと>
- リクエストを処理するコントローラとアクションは、ブラウザからのリクエストに含まれるURLとHTTPメソッドによって決定される。
- コントローラのアクションを設計する際には、入口となるURLとHTTPメソッドをあわせて考える必要がある。

## 新規登録機能を実装する

### 一覧画面に新規登録リンクを追加する
今回はbtnとbtn-primaryという2つのCSSクラスを与える。
link_toメソッドは<a href='...'></a>というようなHTMLの要素を出力するメソッド

### モデルの翻訳情報を追加する
Taskモデルの翻訳情報をconfig/locals/ja.ymlに追加しておく。
モデルの名前はactiverecodeのmodelsの下に、属性の名前はactiverecordのattributesにそれぞれ定義する

### 新規登録画面のためのアクションを実装する
新しいTaskオブジェクトを生成してインスタンス変数@taskに代入しておく
コントローラーのインスタンス変数は、ビューからも見ることができる。
アクションからビューに受け渡しをしたいデータをインスタンス変数に入れることが、アクションの基本的な役割の一つになる。

### アクションへデータを送る「リクエストパラメータ」

リクエストパラメータ: リクエストにデータを添える際のデータのこと。

リクエストパラメータの送り方はHTTPの仕組みの上で2通りに分かれる。
- POSTで送る。基本的にはHTMLのform要素をsubmitすることで送られる
- GETで送る。基本的にはURLの?以降に情報を含めることで送る。普通に?のついたURLにブラウザからアクセスする他、form要素のmethod属性にgetを指定して、form要素のsubmitを通じてそのようなリクエストを送ることもできる。

### 新規登録画面のビューを実装する
この画面では、先程アクションで用意した新しいタスクのオブジェクト(@task)を利用して、登録フォームを表示する。
それにはfotm_withというメソッドを利用する。
form_with: モデルオブジェクトを使ってHTMLのform要素を作成するためのメソッド

### 登録アクションを実装する
登録アクションはTaskControllerのcreateアクションとして実装する。
ここに「登録フォームから送られてきたデータをデータベースに保存して、一覧画面に遷移する」という処理を書いていく
